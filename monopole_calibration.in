## Calibration simulation: Single monopole antenna in free space
## Purpose: Extract antenna S11 for de-embedding
#title: monopole_calibration_freespace

## Domain - larger to accommodate antenna and PML
#domain: 0.5 0.5 0.5
#dx_dy_dz: 0.002 0.002 0.002
#time_window: 20e-9

## Waveform - Gaussian pulse at 1 GHz
#waveform: gaussian 1 1e9 my_pulse

## Materials
## PEC for ground plane
#material: inf 0 1 0 pec

## Antenna geometry
## Center antenna at domain center for symmetry
## Antenna position
#python:
antenna_x = 0.25
antenna_y = 0.25
antenna_z_base = 0.20  # Ground plane level

## Ground plane dimensions
gp_half_size = 0.1125  # 225mm / 2
gp_thickness = 0.002   # 1 cell

## Monopole dimensions
monopole_length = 0.075  # 75 mm (λ/4 at 1 GHz)
wire_radius = 0.001      # 1 mm

## Ground plane (PEC box, horizontal)
x1 = antenna_x - gp_half_size
x2 = antenna_x + gp_half_size
y1 = antenna_y - gp_half_size
y2 = antenna_y + gp_half_size
z1 = antenna_z_base
z2 = antenna_z_base + gp_thickness
#end_python:

#box: {x1} {y1} {z1} {x2} {y2} {z2} pec

## Monopole element (thin wire along z-axis)
## Using #cylinder for the monopole
#python:
monopole_top = antenna_z_base + gp_thickness + monopole_length
#end_python:

#cylinder: {antenna_x} {antenna_y} {z2} {antenna_x} {antenna_y} {monopole_top} {wire_radius} pec

## Feed point: transmission line at base of monopole
## This creates a 50Ω port
#transmission_line: z {antenna_x} {antenna_y} {z2} 50 my_pulse

## Receiver at the same location to measure reflected signal
## For S11 measurement, we need voltage and current at the port
## gprMax transmission_line sources automatically provide I and V output
## We can also add an rx to verify field behavior
#rx: {antenna_x} {antenna_y} {z2}

## Geometry view (optional - comment out for faster run)
##geometry_view: 0 0 0 0.5 0.5 0.5 0.002 0.002 0.002 monopole_calibration n

## End of calibration input file
